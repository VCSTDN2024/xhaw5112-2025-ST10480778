<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Course Payment | Empowering The Nation</title>
  <style>
    /* ------------------- */
    /* Global Styles & Variables */
    /* ------------------- */
    :root {
      --primary-color: #FFBF00; /* Yellow */
      --secondary-color: #7FA75D; 
      --brand-dark-green: #006600;
      --accent-color: #4CAF50; /* Green for success/buttons */
      --text-dark: #333;
      --text-light-gray: #555;
      --bg-white: #fff;
      --bg-light-gray: #f4f6f9;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: Arial, sans-serif;
      background: var(--bg-light-gray);
      color: var(--text-dark);
      min-height: 100vh;
      line-height: 1.6;
    }
    a { text-decoration: none; color: var(--brand-dark-green); }

    /* ------------------- */
    /* Navigation Styles */
    /* ------------------- */
    nav { display: flex; justify-content: space-between; align-items: center; background: var(--primary-color); padding: 10px 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: bold; }
    .brand img { height: 40px; width: auto; }
    nav ul { list-style: none; display: flex; gap: 20px; }
    nav ul li a { color: var(--brand-dark-green); text-decoration: none; font-weight: bold; }
    .dropdown { position: relative; }
    .dropdown .dropdown-content { display: none; position: absolute; top: 100%; left: 0; background-color: var(--bg-white); min-width: 180px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); z-index: 99; }
    .dropdown:hover .dropdown-content { display: block; }
    .dropdown-content a { color: var(--text-dark); padding: 10px 16px; display: block; }
    .dropdown-content a:hover { background-color: #f2f2f2; }
    .sub-dropdown .sub-dropdown-content { display: none; position: absolute; left: 100%; top: 0; background-color: var(--bg-white); min-width: 180px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); z-index: 100; }
    .sub-dropdown:hover .sub-dropdown-content { display: block; }
    
    /* ------------------- */
    /* Card Container Styling (Medium & Pleasing) */
    /* ------------------- */
    .container {
      max-width: 650px; /* Medium width */
      margin: 50px auto;
      padding: 0 20px;
    }
    .card {
        background: var(--bg-white);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0,0,0,0.1); /* Soft, pleasing shadow */
        border: 1px solid #e0e0e0;
    }
    
    h2 {
        text-align: center;
        font-size: 1.8rem;
        color: var(--brand-dark-green);
        margin-bottom: 25px;
    }

    /* ------------------- */
    /* Table Styling */
    /* ------------------- */
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin-bottom: 25px;
        border: 1px solid #e0e0e0; 
        border-radius: 8px; 
        overflow: hidden; 
    }
    th, td { 
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #eee; 
    }
    th { 
      background: var(--brand-dark-green); /* Better color for header */
      color: white; 
      font-weight: 600;
    }
    table tbody tr:last-child td { border-bottom: none; }
    table tbody tr:nth-child(even) { background-color: #f9f9f9; } /* Subtle stripe */
    
    /* ------------------- */
    /* Totals Styling */
    /* ------------------- */
    .totals-container {
        padding-top: 15px;
        margin-top: 20px;
        border-top: 2px solid var(--primary-color);
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    .totals { 
        display: flex;
        justify-content: space-between;
        font-size: 1rem;
        padding: 3px 0;
    }
    .totals strong {
        font-weight: 700;
        color: var(--text-dark);
    }
    .discount { 
        color: #e74c3c; /* Red for discount */
    }
    #total-amount {
        font-size: 1.4rem;
        font-weight: 800;
        color: var(--accent-color);
        padding-top: 10px;
        border-top: 1px dashed #ccc;
        margin-top: 10px;
    }
    
    /* ------------------- */
    /* Button Group */
    /* ------------------- */
    .btn-group {
        display: flex;
        gap: 15px;
        margin-top: 30px;
    }
    .btn { 
        flex: 1;
        background: var(--accent-color); 
        color: white; 
        padding: 12px 25px; 
        border: none; 
        border-radius: 8px;
        cursor: pointer; 
        font-weight: 700;
        font-size: 1rem;
        transition: background-color 0.2s, transform 0.2s;
        text-align: center;
    }
    .btn:hover { 
        background: #3e8e41; 
        transform: translateY(-1px);
    }
    .btn-secondary {
        background: var(--primary-color);
        color: var(--text-dark);
    }
    .btn-secondary:hover {
        background: #e6ac00;
    }

    /* ------------------- */
    /* Chatbot Styles (kept from original) */
    /* ------------------- */
    #chatbotBtn { position: fixed; bottom: 20px; right: 20px; background: var(--accent-color); color: white; border: none; border-radius: 50%; width: 60px; height: 60px; font-size: 24px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 1000; display: flex; align-items: center; justify-content: center; }
    .modal-chat { display: none; position: fixed; bottom: 90px; right: 20px; width: 350px; height: 500px; background: #fff; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); flex-direction: column; z-index: 1000; }
    .modal-content-chat { display: flex; flex-direction: column; height: 100%; }
    .chat-header { background: var(--accent-color); color: white; padding: 12px; text-align: center; font-weight: bold; border-radius: 12px 12px 0 0; position: relative; }
    #closeChatModal { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); font-size: 24px; cursor: pointer; color: white; }
    #chat-window { flex: 1; overflow-y: auto; padding: 15px; }
    #chat-log div { margin-bottom: 12px; font-size: 14px; max-width: 80%; }
    .user { text-align: right; color: #333; margin-left: auto; background: #e0f7fa; padding: 8px 12px; border-radius: 12px 12px 0 12px; }
    .bot { text-align: left; color: #444; background: #f1f8e9; padding: 8px 12px; border-radius: 12px 12px 12px 0; }
    #chat-input { display: flex; padding: 10px; border-top: 1px solid #eee; }
    #user-input { flex-grow: 1; padding: 10px 15px; border: 1px solid #ccc; border-radius: 20px; margin-right: 10px; }
    #send-btn { background: var(--accent-color); color: white; border: none; border-radius: 20px; padding: 8px 16px; cursor: pointer; font-weight: 600; }
    .faq-btn { margin: 4px; padding: 8px 12px; background: var(--accent-color); color: white; border: none; border-radius: 6px; cursor: pointer; }
    @media (max-width: 600px) {
        .btn-group { flex-direction: column; }
    }
  </style>
</head>
<body>
  <nav>
      <div class="brand">
        <img src="Media1/Emplogo.png" alt="Empowering the nation">
        <span>Empowering The Nation</span>
      </div>
      <ul>
        <li><a href="home.html"target="_blank">Home</a></li>
        <li class="dropdown">
          <a href="Courses.html">Courses</a>
          <ul class="dropdown-content">
            <li class="sub-dropdown">
              <a href="#">6 Weeks ▸</a>
              <ul class="sub-dropdown-content">
                <li><a href="detailed Courses.html#childminding" class="course-link">Childminding</a></li>
                <li><a href="detailed Courses.html#cooking" class="course-link">Cooking</a></li>
                <li><a href="detailed Courses.html#garden-maintenance" class="course-link">Garden Maintenance</a></li>
              </ul>
            </li>
            <li class="sub-dropdown">
              <a href="#">6 Months ▸</a>
              <ul class="sub-dropdown-content">
                <li><a href="detailed Courses.html#landscaping" class="course-link">Landscaping</a></li>
                <li><a href="detailed Courses.html#first-aid" class="course-link">First Aid</a></li>
                <li><a href="detailed Courses.html#life-skills" class="course-link">Life Skills</a></li>
                <li><a href="detailed Courses.html#sewing" class="course-link">Sewing</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="getqoute.html"target="_blank">Get Quote</a></li>
        <li><a href="about us.html"target="_blank">About Us</a></li>
        <li><a href="contact us.html"target="_blank">Contact Us</a></li>
      </ul>
  </nav>

  <main class="container">
    <div class="card">
      <h2>Order Summary</h2>
      
      <table id="courseTable">
        <thead>
          <tr>
            <th>Course Name</th>
            <th>Duration</th>
            <th>Pricing (R)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="totals-container">
        <p class="totals" id="subtotal">Subtotal: <strong>R0.00</strong></p>
        <p class="totals discount" id="discount">Discount: 0% Applied (<strong>- R0.00</strong>)</p>
        <p class="totals" id="vat">VAT (15%): <strong>R0.00</strong></p>
        <p class="totals" id="total-amount">Total Payable: <strong>R0.00</strong></p>
      </div>

      <div class="btn-group">
        <button class="btn" onclick="alert('Simulated: Proceeding to secure payment portal.')">Pay Now</button>
        <button class="btn btn-secondary" id="goDashboard">Go to Dashboard</button>
      </div>
    </div>
  </main>

  <button id="chatbotBtn">💬</button>
  <div id="chatbotModal" class="modal-chat">
    <div class="modal-content-chat">
      <div class="chat-header">
        Empowering The Nation Bot
        <span id="closeChatModal">&times;</span>
      </div>
      <div id="chat-window"><div id="chat-log"></div></div>
      <div id="chat-input">
        <input type="text" id="user-input" placeholder="Type a message...">
        <button id="send-btn">Send</button>
      </div>
    </div>
  </div>
  
  <script>
    // -------------------
    // Order Summary Logic
    // -------------------
     document.addEventListener("DOMContentLoaded", () => {
      // Retrieve data from localStorage (set on the getqoute/checkout page)
      const courseDetails = JSON.parse(localStorage.getItem("courseDetails")) || [];
      const subtotal = localStorage.getItem("subtotal") || "0.00";
      const discount = localStorage.getItem("discount") || "0.00";
      const discountRate = localStorage.getItem("discountRate") || "0%";
      const vat = localStorage.getItem("vat") || "0.00";
      const total = localStorage.getItem("total") || "0.00";

      const tableBody = document.querySelector("#courseTable tbody");
      
      // Populate the table rows
      if (courseDetails.length === 0) {
        let row = document.createElement("tr");
        row.innerHTML = `<td colspan="3" style="text-align: center; color: var(--text-light-gray); padding: 20px;">No courses added to your order.</td>`;
        tableBody.appendChild(row);
      } else {
        courseDetails.forEach(c => {
          let row = document.createElement("tr");
          row.innerHTML = `<td>${c.name}</td><td>${c.duration}</td><td>R${parseFloat(c.price).toFixed(2)}</td>`;
          tableBody.appendChild(row);
        });
      }

      // Populate the total summary details
      document.getElementById("subtotal").innerHTML = `Subtotal: <strong>R${parseFloat(subtotal).toFixed(2)}</strong>`;
      document.getElementById("discount").innerHTML = `Discount: ${discountRate} Applied (<strong>- R${parseFloat(discount).toFixed(2)}</strong>)`;
      document.getElementById("vat").innerHTML = `VAT (15%): <strong>R${parseFloat(vat).toFixed(2)}</strong>`;
      document.getElementById("total-amount").innerHTML = `Total Payable: <strong>R${parseFloat(total).toFixed(2)}</strong>`;
    });
    
    // -------------------
    // Dashboard Redirection Logic
    // -------------------
    document.getElementById("goDashboard").addEventListener("click", () => {
      const courseDetails = JSON.parse(localStorage.getItem("courseDetails")) || [];

      // Assign random initial progress for purchased courses
      courseDetails.forEach(c => {
        // Sets progress between 2% and 7%
        c.progress = Math.floor(Math.random() * 6) + 2; 
      });

      // Save purchased courses + progress in localStorage for dashboard to read
      localStorage.setItem("purchasedCourses", JSON.stringify(courseDetails));

      // Redirect to dashboard
      window.location.href = "dashboard.html";
    });

    // -------------------
    // ChatBot Functions
    // -------------------
    document.getElementById("chatbotBtn").onclick = () => {
        const modal = document.getElementById("chatbotModal");
        if (modal.style.display !== "flex") {
            modal.style.display = "flex";
            if (!document.getElementById("chat-log").hasChildNodes()) {
                addMessage("bot", "Hi 👋! How can I help you today?<br>Type 'faq' to see our help menu.");
            }
        }
    };
    document.getElementById("closeChatModal").onclick = () => { document.getElementById("chatbotModal").style.display = "none"; };
    document.getElementById("send-btn").onclick = sendMessage;
    document.getElementById("user-input").addEventListener("keypress", (e) => { if (e.key === "Enter") sendMessage(); });
    
    function sendMessage() {
        const input = document.getElementById("user-input");
        const message = input.value.trim();
        if (!message) return;
        addMessage("user", message);
        input.value = "";
        setTimeout(() => handleBotResponse(message.toLowerCase()), 500);
    }
    
    function addMessage(sender, text) {
        const log = document.getElementById("chat-log");
        const div = document.createElement("div");
        div.className = sender;
        div.innerHTML = text;
        log.appendChild(div);
        log.scrollTop = log.scrollHeight;
    }
    
    function handleBotResponse(userMessage) {
        if (userMessage.includes("hi") || userMessage.includes("hello")) {
            addMessage("bot", "Hello! 😊 How can I help you today? Type 'faq' to see the menu.");
        } else if (userMessage.includes("faq")) {
            addMessage("bot", `
            Please select a category:<br>
            <button class="faq-btn" onclick="showFAQ('locations')">📍 Locations</button>
            <button class="faq-btn" onclick="showFAQ('payments')">💳 Payments</button>
            <button class="faq-btn" onclick="showFAQ('contact')">📞 Contact</button>
            <button class="faq-btn" onclick="showFAQ('courses')">📚 Courses</button>
            `);
        } else {
            addMessage("bot", "Sorry, I didn’t quite get that. Try typing 'faq' for options.");
        }
    }
    
    function showFAQ(category) {
        let faqs = {
            locations: `<div class="accordion"><details open><summary>Where are your locations?</summary><p>We are in Johannesburg South, Soweto, Roodepoort, and Sandton.<br><a href='contact-us.html'>📍 View on map</a></p></details></div>`,
            payments: `<div class="accordion"><details open><summary>How do I pay?</summary><p>You can pay online via EFT or card. <a href='getqoute.html'>💳 Go to payment page</a></p></details></div>`,
            contact: `<div class="accordion"><details open><summary>How can I contact you?</summary><p>You can reach us via our <a href='contact-us.html'>Contact Page</a> or call 011-123-4567.</p></details></div>`,
            courses: `<div class="accordion"><details open><summary>What courses do you offer?</summary><p>We offer First Aid, Sewing, Cooking, Landscaping, Child Minding, Life Skills, and Garden Maintenance.<br><a href='Courses.html'>📚 View all courses</a></p></details></div>`
        };
        addMessage("bot", faqs[category]);
    }
  </script>
</body>
</html>